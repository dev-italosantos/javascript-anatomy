<input type="file" onchange="parseExcelFile1(this)">

<script>

  function parseExcelFile1(inputElement) {
    let files = inputElement.files || [];
    if (!files.length) return;
    let file = files[0];

    console.time();

    let reader = new FileReader();

    reader.onloadend = function (event) {

      let arrayBuffer = reader.result;

      var options = { type: "base64", cellText: false, cellDates: true }
      var workbook = XLSX.read(arrayBuffer, options);

      var sheetName = workbook.SheetNames
      var sheet = workbook.Sheets[sheetName]

      console.log(sheet);

      var range = XLSX.utils.decode_range(sheet['!ref']);
      var ncols = range.e.c - range.s.c + 1, nrows = range.e.r - range.s.r + 1;

      console.log(nrows);

      let rows = XLSX.utils.sheet_to_json(sheet)

      console.log(rows)

      if (!rows.length) {
        throw 'Não foi possível ler os dados do arquivo.';
      }

      console.timeEnd();

      let itens = rows.filter(a => a !== null).filter((este, i) => rows.filter(a => a !== null).map(a => a._id).indexOf(este._id) === i);

      console.log(itens)

    };

    //reader.readAsArrayBuffer(file);
    reader.readAsText(file);

  }

</script>

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>